---
title: "Examining background gene lists using simulation - comparison of different enrichment techniques"
author: "Mark Ziemann & Anusuiya Bora"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
    fig_width: 7
    fig_height: 5
theme: cosmo
---

Source: https://github.com/markziemann/background

```{r,libs}

library("parallel")
library("edgeR")
library("DESeq2")
library("limma")
library("stringi")
library("kableExtra")
library("fgsea")
library("clusterProfiler")
source("simpw_func.R")
library("RhpcBLASctl")
library("vioplot")
library("beeswarm")

RhpcBLASctl::blas_set_num_threads(1)

```

## Intro

TODO


xxx object slots

1. expression counts

2. ground truth up genes

3. ground truth down genes

4. ground truth up gene sets

5. ground truth down gene sets

6. DE result (DESeq2)

7. DE genes up observed

8. DE genes down observed

9. clusterprofiler_default up gene sets

10. clusterprofiler_default down gene sets

11. clusterprofiler bg fix up gene sets

12. clusterprofiler bg fix down gene sets

13. clusterprofiler FDR fix up gene sets

14. clusterprofiler FDR fix down gene sets

15. clusterprofiler BG and FDR fix up gene sets

16. clusterprofiler BG and FDR fix down gene sets

17. fora up gene sets

18. fora down gene sets

19. fgsea up gene sets

20. fgsea down gene sets

# Get count data

```{r,getcounts,warning=FALSE}

a <- countData()

```

# Generate gene sets

```{r,genesetgeneration}

gsets <- randomGeneSets(a,setsize=30,nsets=200)

```

# run simulations over a range of parameters

```{r,setparameters}

SIMS=32
#run 1000 sims
FRAC_DE=0.05
FC=0.5
N_REPS=3
DGE_FUNC="deseq2"
SUM_COUNT=2e7
VARIANCE=c(0,0.1,0.2,0.3,0.4,0.5,0.6)

mygrid <- expand.grid(FRAC_DE,FC,N_REPS,DGE_FUNC,SUM_COUNT,VARIANCE)
colnames(mygrid) <- c("FRAC_DE","FC","N_REPS","DGE_FUNC","SUM_COUNT","VARIANCE")

mygrid

```

Now run the analysis.

```{r,sims}

res <- lapply(1:nrow(mygrid), function(i) {
  FRAC_DE=mygrid[i,"FRAC_DE"]
  FC=mygrid[i,"FC"]
  N_REPS=mygrid[i,"N_REPS"]
  DGE_FUNC=as.character(mygrid[i,"DGE_FUNC"])
  SUM_COUNT=mygrid[i,"SUM_COUNT"]
  VARIANCE=mygrid[i,"VARIANCE"]
  agg_dge(a,N_REPS,SUM_COUNT,VARIANCE,FRAC_DE,FC,SIMS,DGE_FUNC,gsets,cores=32)
})

saveRDS(res,file="res.Rds")

```

## Aggregate data for charting as vioplot

```{r,vioagg}

prf <- function(cp) {
  cp2 <- lapply(cp,function(df) {
    df$p <- df$true_pos/(df$true_pos+ df$false_pos)
    df$r <- df$true_pos/(df$true_pos+ df$false_neg)
    df$f <- 2*df$p*df$r/(df$p+df$r)
    df
  } )
  cp2p <- lapply(cp2,"[[","p")
  cp2p <- lapply(cp2p,function(x) { x[is.na(x) ]<- 0 ; x } )
  cp2r <- lapply(cp2,"[[","r")
  cp2r <- lapply(cp2r,function(x) { x[is.na(x) ]<- 0 ; x } )
  cp2f <- lapply(cp2,"[[","f")
  cp2f <- lapply(cp2f,function(x) { x[is.na(x) ]<- 0 ; x } )
  names(cp2p) <- names(cp2r) <- names(cp2f) <- c("0","0.1","0.2","0.3","0.4","0.5","0.6")
  res=list("p"=cp2p,"r"=cp2r,"f"=cp2f)
  return(res)
}

par(mfrow=c(3,3))

## clusterprofiler default
cp <- lapply(res,"[[",1)
cp2 <- prf(cp)
vioplot(cp2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler") ; grid()
vioplot(cp2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler") ; grid()
vioplot(cp2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler") ; grid()

## clusterprofiler bgfix
cpbg <- lapply(res,"[[",2)
cpbg2 <- prf(cpbg)
vioplot(cpbg2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler BG fix") ; grid()
vioplot(cpbg2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler BG fix") ; grid()
vioplot(cpbg2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler BG fix") ; grid()

## clusterprofiler FDR fix
cpfdr <- lapply(res,"[[",3)
cpfdr2 <- prf(cpfdr)
vioplot(cpfdr2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler FDR fix") ; grid()
vioplot(cpfdr2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler FDR fix") ; grid()
vioplot(cpfdr2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler FDR fix") ; grid()

## clusterprofiler BG and FDR fix
cpbgfdr <- lapply(res,"[[",4)
cpbgfdr2 <- prf(cpbgfdr)
vioplot(cpbgfdr2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler BG and FDR fix") ; grid()
vioplot(cpbgfdr2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler BG and FDR fix") ; grid()
vioplot(cpbgfdr2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler BG and FDR fix") ; grid()

## FORA
fo <- lapply(res,"[[",5)
fo2 <- prf(fo)
vioplot(fo2[["p"]],xlab="introduced noise",ylab="precision",main="fora") ; grid()
vioplot(fo2[["r"]],xlab="introduced noise",ylab="recall",main="fora") ; grid()
vioplot(fo2[["f"]],xlab="introduced noise",ylab="F1",main="fora") ; grid()

## FGSEA
fg <- lapply(res,"[[",6)
fg2 <- prf(fg)
vioplot(fg2[["p"]],xlab="introduced noise",ylab="precision",main="fgsea") ; grid()
vioplot(fg2[["r"]],xlab="introduced noise",ylab="recall",main="fgsea") ; grid()
vioplot(fg2[["f"]],xlab="introduced noise",ylab="F1",main="fgsea") ; grid()

png("fig3_vio.png", width=7,height=7,units="in",res=150,pointsize=12)
par(mfrow=c(3,3))
vioplot(cp2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler") ; grid()
vioplot(cp2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler") ; grid()
vioplot(cp2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler") ; grid()
vioplot(cpbg2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler BG fix") ; grid()
vioplot(cpbg2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler BG fix") ; grid()
vioplot(cpbg2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler BG fix") ; grid()
vioplot(cpfdr2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler FDR fix") ; grid()
vioplot(cpfdr2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler FDR fix") ; grid()
vioplot(cpfdr2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler FDR fix") ; grid()
dev.off()
png("fig3_vio2.png", width=7,height=7,units="in",res=150,pointsize=12)
par(mfrow=c(3,3))
vioplot(cpbgfdr2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler BG and FDR fix") ; grid()
vioplot(cpbgfdr2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler BG and FDR fix") ; grid()
vioplot(cpbgfdr2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler BG and FDR fix") ; grid()
vioplot(fo2[["p"]],xlab="introduced noise",ylab="precision",main="fora") ; grid()
vioplot(fo2[["r"]],xlab="introduced noise",ylab="recall",main="fora") ; grid()
vioplot(fo2[["f"]],xlab="introduced noise",ylab="F1",main="fora") ; grid()
vioplot(fg2[["p"]],xlab="introduced noise",ylab="precision",main="fgsea") ; grid()
vioplot(fg2[["r"]],xlab="introduced noise",ylab="recall",main="fgsea") ; grid()
vioplot(fg2[["f"]],xlab="introduced noise",ylab="F1",main="fgsea") ; grid()
dev.off()

pdf("fig3_vio.pdf", width=7,height=7,pointsize=12)
par(mfrow=c(3,3))
vioplot(cp2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler") ; grid()
vioplot(cp2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler") ; grid()
vioplot(cp2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler") ; grid()
vioplot(cpbg2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler BG fix") ; grid()
vioplot(cpbg2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler BG fix") ; grid()
vioplot(cpbg2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler BG fix") ; grid()
vioplot(cpfdr2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler FDR fix") ; grid()
vioplot(cpfdr2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler FDR fix") ; grid()
vioplot(cpfdr2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler FDR fix") ; grid()
vioplot(cpbgfdr2[["p"]],xlab="introduced noise",ylab="precision",main="clusterProfiler BG and FDR fix") ; grid()
vioplot(cpbgfdr2[["r"]],xlab="introduced noise",ylab="recall",main="clusterProfiler BG and FDR fix") ; grid()
vioplot(cpbgfdr2[["f"]],xlab="introduced noise",ylab="F1",main="clusterProfiler BG and FDR fix") ; grid()
vioplot(fo2[["p"]],xlab="introduced noise",ylab="precision",main="fora") ; grid()
vioplot(fo2[["r"]],xlab="introduced noise",ylab="recall",main="fora") ; grid()
vioplot(fo2[["f"]],xlab="introduced noise",ylab="F1",main="fora") ; grid()
vioplot(fg2[["p"]],xlab="introduced noise",ylab="precision",main="fgsea") ; grid()
vioplot(fg2[["r"]],xlab="introduced noise",ylab="recall",main="fgsea") ; grid()
vioplot(fg2[["f"]],xlab="introduced noise",ylab="F1",main="fgsea") ; grid()
dev.off()


```

Now show the results.

```{r,results}

res2 <- lapply(res,function(x) { lapply(x,function(y) { colMeans(y[,1:3]) } ) } )
res2 <- lapply(res2,function(x) {
  out <- as.data.frame(do.call(rbind,x))
  PWAY_FUNC  <- c("clusterProfiler default","clusterProfiler BG fix","clusterProfiler FDR fix",
    "clusterProfiler BG and FDR fix","fora","fgsea")
  out$PWAY_FUNC  <- PWAY_FUNC
  out
} )
res3 <- do.call(rbind,res2)
res3$VARIANCE <- c(rep(0,6),rep(0.1,6),rep(0.2,6),rep(0.3,6),rep(0.4,6),rep(0.5,6),rep(0.6,6))

res3$p <- res3$true_pos/(res3$true_pos+ res3$false_pos)
res3$r <- res3$true_pos/(res3$true_pos+ res3$false_neg)
res3$f <- 2*res3$p*res3$r/(res3$p+res3$r)

res %>% kbl(caption="simulation_results") %>% kable_paper("hover", full_width = F)

```

## Plot

```{r,plot1}

cp <- subset(res3,PWAY_FUNC == "clusterProfiler default")
cpbg <- subset(res3,PWAY_FUNC == "clusterProfiler BG fix")
cpfdr <- subset(res3,PWAY_FUNC == "clusterProfiler FDR fix")
cpbgfdr <- subset(res3,PWAY_FUNC == "clusterProfiler BG and FDR fix")
fo <- subset(res3,PWAY_FUNC == "fora")
fg <- subset(res3,PWAY_FUNC == "fgsea")

cp %>% kbl(caption="clusterProfiler") %>% kable_paper("hover", full_width = F)
cpbg %>% kbl(caption="clusterProfiler with background bug fix") %>% kable_paper("hover", full_width = F)
cpfdr %>% kbl(caption="clusterProfiler with FDR bug fix") %>% kable_paper("hover", full_width = F)
cpbgfdr %>% kbl(caption="clusterProfiler with background and FDR fixes") %>% kable_paper("hover", full_width = F)
fo %>% kbl(caption="fora") %>% kable_paper("hover", full_width = F)
fg %>% kbl(caption="fg") %>% kable_paper("hover", full_width = F)

par(mfrow=c(1,3))
par(mar=c(c(5.1, 5.1, 2.1, 2.1) ))

plot(cp$VARIANCE,cp$p,ylim=c(0,1),type="b",pch=19,xlab="variance added",ylab="index",main="precision")
points(cpbg$VARIANCE,cpbg$p,type="b",pch=19,col="orange")
points(cpfdr$VARIANCE,cpfdr$p,type="b",pch=19,col="darkgreen")
points(cpbgfdr$VARIANCE,cpbgfdr$p,type="b",pch=19,col="purple")
points(fo$VARIANCE,fo$p,type="b",pch=19,col="red")
points(fg$VARIANCE,fg$p,type="b",pch=19,col="blue")

legend("bottomleft", inset=.02, title="tool",
   c("CP default","CP BG fix","CP FDR fix","CP BG and FDR fix","fora","fgsea"),
   col=c("black","orange","darkgreen","purple","red","blue"),horiz=FALSE, cex=1.0, pch=19,lwd=2)

plot(cp$VARIANCE,cp$r,ylim=c(0,1),type="b",pch=19,xlab="variance added",ylab="index",main="recall")
points(cpbg$VARIANCE,cpbg$r,type="b",pch=19,col="orange")
points(cpfdr$VARIANCE,cpfdr$r,type="b",pch=19,col="darkgreen")
points(cpbgfdr$VARIANCE,cpbgfdr$r,type="b",pch=19,col="purple")
points(fo$VARIANCE,fo$r,type="b",pch=19,col="red")
points(fg$VARIANCE,fg$r,type="b",pch=19,col="blue")

plot(cp$VARIANCE,cp$f,ylim=c(0,1),type="b",pch=19,xlab="variance added",ylab="index",main="f1")
points(cpbg$VARIANCE,cpbg$f,type="b",pch=19,col="orange")
points(cpfdr$VARIANCE,cpfdr$f,type="b",pch=19,col="darkgreen")
points(cpbgfdr$VARIANCE,cpbgfdr$f,type="b",pch=19,col="purple")
points(fo$VARIANCE,fo$f,type="b",pch=19,col="red")
points(fg$VARIANCE,fg$f,type="b",pch=19,col="blue")


png("fig3_sim.png", width=7,height=5,units="in",res=150,pointsize=12)
par(mar=c(c(5.1, 5.1, 2.1, 2.1) ))
par(mfrow=c(1,3))

plot(cp$VARIANCE,cp$p,ylim=c(0,1),type="b",pch=19,xlab="variance added",ylab="index",main="precision")
points(cpbg$VARIANCE,cpbg$p,type="b",pch=19,col="orange")
points(cpfdr$VARIANCE,cpfdr$p,type="b",pch=19,col="darkgreen")
points(cpbgfdr$VARIANCE,cpbgfdr$p,type="b",pch=19,col="purple")
points(fo$VARIANCE,fo$p,type="b",pch=19,col="red")
points(fg$VARIANCE,fg$p,type="b",pch=19,col="blue")
grid()
legend("bottomleft", inset=.02, title="tool",
   c("CP default","CP BG fix","CP FDR fix","CP BG and FDR fix","fora","fgsea"),
   col=c("black","orange","darkgreen","purple","red","blue"),
   horiz=FALSE, cex=1.0, pch=19,lwd=2)

plot(cp$VARIANCE,cp$r,ylim=c(0,1),type="b",pch=19,xlab="variance added",ylab="index",main="recall")
points(cpbg$VARIANCE,cpbg$r,type="b",pch=19,col="orange")
points(cpfdr$VARIANCE,cpfdr$r,type="b",pch=19,col="darkgreen")
points(cpbgfdr$VARIANCE,cpbgfdr$r,type="b",pch=19,col="purple")
points(fo$VARIANCE,fo$r,type="b",pch=19,col="red")
points(fg$VARIANCE,fg$r,type="b",pch=19,col="blue")
grid()

plot(cp$VARIANCE,cp$f,ylim=c(0,1),type="b",pch=19,xlab="variance added",ylab="index",main="f1")
points(cpbg$VARIANCE,cpbg$f,type="b",pch=19,col="orange")
points(cpfdr$VARIANCE,cpfdr$f,type="b",pch=19,col="darkgreen")
points(cpbgfdr$VARIANCE,cpbgfdr$f,type="b",pch=19,col="purple")
points(fo$VARIANCE,fo$f,type="b",pch=19,col="red")
points(fg$VARIANCE,fg$f,type="b",pch=19,col="blue")
grid()
dev.off()

#################################

pdf("fig3_sim.pdf", width=7,height=5,pointsize=12)
par(mar=c(c(5.1, 5.1, 2.1, 2.1) ))
par(mfrow=c(1,3))

plot(cp$VARIANCE,cp$p,ylim=c(0,1),type="b",pch=19,xlab="variance added",ylab="index",main="precision")
points(cpbg$VARIANCE,cpbg$p,type="b",pch=19,col="orange")
points(cpfdr$VARIANCE,cpfdr$p,type="b",pch=19,col="darkgreen")
points(cpbgfdr$VARIANCE,cpbgfdr$p,type="b",pch=19,col="purple")
points(fo$VARIANCE,fo$p,type="b",pch=19,col="red")
points(fg$VARIANCE,fg$p,type="b",pch=19,col="blue")
grid()
legend("bottomleft", inset=.02, title="tool",
   c("CP default","CP BG fix","CP FDR fix","CP BG and FDR fix","fora","fgsea"),
   col=c("black","orange","darkgreen","purple","red","blue"),
   horiz=FALSE, cex=1.0, pch=19,lwd=2)

plot(cp$VARIANCE,cp$r,ylim=c(0,1),type="b",pch=19,xlab="variance added",ylab="index",main="recall")
points(cpbg$VARIANCE,cpbg$r,type="b",pch=19,col="orange")
points(cpfdr$VARIANCE,cpfdr$r,type="b",pch=19,col="darkgreen")
points(cpbgfdr$VARIANCE,cpbgfdr$r,type="b",pch=19,col="purple")
points(fo$VARIANCE,fo$r,type="b",pch=19,col="red")
points(fg$VARIANCE,fg$r,type="b",pch=19,col="blue")
grid()

plot(cp$VARIANCE,cp$f,ylim=c(0,1),type="b",pch=19,xlab="variance added",ylab="index",main="f1")
points(cpbg$VARIANCE,cpbg$f,type="b",pch=19,col="orange")
points(cpfdr$VARIANCE,cpfdr$f,type="b",pch=19,col="darkgreen")
points(cpbgfdr$VARIANCE,cpbgfdr$f,type="b",pch=19,col="purple")
points(fo$VARIANCE,fo$f,type="b",pch=19,col="red")
points(fg$VARIANCE,fg$f,type="b",pch=19,col="blue")
grid()
dev.off()

```

Barplot is simpler.

```{r,bars}

prec <- c("CP default"=mean(cp$p),"CP BG fix"=mean(cpbg$p),"CP FDR fix"=mean(cpfdr$p),"CP BG and FDR fix"=mean(cpbgfdr$p),"fora"=mean(fo$p),"fgsea"=mean(fg$p))
rec <- c("CP default"=mean(cp$r),"CP BG fix"=mean(cpbg$r),"CP FDR fix"=mean(cpfdr$r),"CP BG and FDR fix"=mean(cpbgfdr$r),"fora"=mean(fo$r),"fgsea"=mean(fg$r))
f1 <- sapply(1:length(prec), function(i) { 2/(1/rec[i]+1/prec[i]) })

par(mfrow=c(1,3))
par(mar=c(c(9.1, 3.5, 2.1, 1.1) ))
barplot(prec,ylim=c(0,1.1),las=2,main="precision",ylab="")
text((1:6*1.18)-0.45,prec+0.02,labels=signif(prec,3))
barplot(rec,ylim=c(0,1.1),las=2,main="recall",ylab="")
text((1:6*1.18)-0.45,rec+0.02,labels=signif(rec,3))
barplot(f1,ylim=c(0,1.1),las=2,main="F1",ylab="")
text((1:6*1.18)-0.45,f1+0.02,labels=signif(f1,3))

png("fig3_bars.png", width=7,height=5,units="in",res=150,pointsize=12)
par(mar=c(c(9.1, 3.5, 2.1, 1.1) ))
par(mfrow=c(1,3))
barplot(prec,ylim=c(0,1.1),las=2,main="precision",ylab="")
text((1:6*1.18)-0.45,prec+0.02,labels=signif(prec,3))
barplot(rec,ylim=c(0,1.1),las=2,main="recall",ylab="")
text((1:6*1.18)-0.45,rec+0.02,labels=signif(rec,3))
barplot(f1,ylim=c(0,1.1),las=2,main="F1",ylab="")
text((1:6*1.18)-0.45,f1+0.02,labels=signif(f1,3))
dev.off()

#################################
pdf("fig3_bars.pdf", width=7,height=5,pointsize=12)
par(mar=c(c(9.1, 3.5, 2.1, 1.1) ))
par(mfrow=c(1,3))
barplot(prec,ylim=c(0,1.1),las=2,main="precision",ylab="")
text((1:6*1.18)-0.45,prec+0.02,labels=signif(prec,3))
barplot(rec,ylim=c(0,1.1),las=2,main="recall",ylab="")
text((1:6*1.18)-0.45,rec+0.02,labels=signif(rec,3))
barplot(f1,ylim=c(0,1.1),las=2,main="F1",ylab="")
text((1:6*1.18)-0.45,f1+0.02,labels=signif(f1,3))
dev.off()

######################################
# Now as boxplot

prec <- list("CP default"=cp$p,"CP BG fix"=cpbg$p,"CP FDR fix"=cpfdr$p,"CP BG and FDR fix"=cpbgfdr$p,"fora"=fo$p,"fgsea"=fg$p)
rec <- list("CP default"=cp$r,"CP BG fix"=cpbg$r,"CP FDR fix"=cpfdr$r,"CP BG and FDR fix"=cpbgfdr$r,"fora"=fo$r,"fgsea"=fg$r)
f1 <- lapply(1:length(prec), function(i) { 2/(1/rec[[i]]+1/prec[[i]]) })
names(f1) <- names(prec)

par(mfrow=c(1,3))
par(mar=c(c(9.1, 3.5, 2.1, 1.1) ))
boxplot(prec,cex=0,main="precision",ylab="",col="white",las=2)
beeswarm(prec,add=TRUE,col="black",pch=19)
boxplot(rec,cex=0,main="recall",ylab="",col="white",las=2)
beeswarm(rec,add=TRUE,col="black",pch=19)
boxplot(f1,cex=0,main="F1 index",ylab="",col="white",las=2)
beeswarm(f1,add=TRUE,col="black",pch=19)

png("fig3_box.png", width=7,height=5,units="in",res=150,pointsize=12)
par(mar=c(c(9.1, 3.5, 2.1, 1.1) ))
par(mfrow=c(1,3))
boxplot(prec,cex=0,main="precision",ylab="",col="white",las=2)
beeswarm(prec,add=TRUE,col="black",pch=19)
boxplot(rec,cex=0,main="recall",ylab="",col="white",las=2)
beeswarm(rec,add=TRUE,col="black",pch=19)
boxplot(f1,cex=0,main="F1 index",ylab="",col="white",las=2)
beeswarm(f1,add=TRUE,col="black",pch=19)
dev.off()

pdf("fig3_box.pdf", width=7,height=5,pointsize=12)
par(mar=c(c(9.1, 3.5, 2.1, 1.1) ))
par(mfrow=c(1,3))
boxplot(prec,cex=0,main="precision",ylab="",col="white",las=2)
beeswarm(prec,add=TRUE,col="black",pch=19)
boxplot(rec,cex=0,main="recall",ylab="",col="white",las=2)
beeswarm(rec,add=TRUE,col="black",pch=19)
boxplot(f1,cex=0,main="F1 index",ylab="",col="white",las=2)
beeswarm(f1,add=TRUE,col="black",pch=19)
dev.off()

```

## Session information


```{r,session}

sessionInfo()

```
